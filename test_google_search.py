aW1wb3J0IHB5dGVzdApmcm9tIHNlbGVuaXVtIGltcG9ydCB3ZWJkcml2ZXIKZnJvbSBzZWxlbml1bS53ZWJkcml2ZXIuY2hyb21lLm9wdGlvbnMgaW1wb3J0IE9wdGlvbnMKZnJvbSBzZWxlbml1bS53ZWJkcml2ZXIuY29tbW9uLmJ5IGltcG9ydCBCeQpmcm9tIHNlbGVuaXVtLndlYmRyaXZlci5zdXBwb3J0LnVpIGltcG9ydCBXZWJEcml2ZXJXYWl0CmZyb20gc2VsZW5pdW0ud2ViZHJpdmVyLnN1cHBvcnQgaW1wb3J0IGV4cGVjdGVkX2NvbmRpdGlvbnMgYXMgRUMKCkBweXRlc3QuZml4dHVyZShzY29wZT0ic2Vzc2lvbiIpCmRlZiBjaHJvbWVfb3B0aW9ucygpOgogICAgb3B0aW9ucyA9IE9wdGlvbnMoKQogICAgb3B0aW9ucy5hZGRfYXJndW1lbnQoIi1oZWFkbGVzcyIpCiAgICBvcHRpb25zLmFkZF9hcmd1bWVudCgiLS1kaXNhYmxlLWdwdSIpCiAgICBvcHRpb25zLmFkZF9hcmd1bWVudCgiLS1uby1zYW5kYm94IikKICAgIG9wdGlvbnMuYWRkX2FyZ3VtZW50KCItLXdpbmRvdy1zaXplPTE5MjAsMTA4MCIpCiAgICBvcHRpb25zLmFkZF9hcmd1bWVudCgiLS1kaXNhYmxlLWRldi1zaG0tdXNhZ2UiKQogICAgcmV0dXJuIG9wdGlvbnMKCkBweXRlc3QuZml4dHVyZQpkZWYgZHJpdmVyKGNocm9tZV9vcHRpb25zKToKICAgIGRyaXZlciA9IHdlYmRyaXZlci5DaHJvbWUob3B0aW9ucz1jaHJvbWVfb3B0aW9ucykKICAgIHlpZWxkIGRyaXZlcgogICAgZHJpdmVyLnF1aXQoKQoKQHB5dGVzdC5tYXJrLnVzZWZpeHR1cmVzKCJkcml2ZXIiKQpkZWYgdGVzdF9nb29nbGVfaG9tZXBhZ2VfbG9hZHMoZHJpdmVyKToKICAgIGRyaXZlci5nZXQoImh0dHBzOi8vd3d3Lmdvb2dsZS5jb20iKQogICAgYXNzZXJ0ICJHb29nbGUiIGluIGRyaXZlci50aXRsZQoKZGVmIHRlc3Rfc2VhcmNoX2JveF9pc19kaXNwbGF5ZWQoZHJpdmVyKToKICAgIGRyaXZlci5nZXQoImh0dHBzOi8vd3d3Lmdvb2dsZS5jb20iKQogICAgc2VhcmNoX2JveCA9IFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoCiAgICAgICAgRUMucHJlc2VuY2Vfb2ZfZWxlbWVudF9sb2NhdGVkKCBCeS5OQU1FLCAncScgKQogICAgKQogICAgYXNzZXJ0IHNlYXJjaF9ib3guaXNfZGlzcGxheWVkKCkKCmRlZiB0ZXN0X3NlYXJjaF9mb3Jfc2VsZW5pdW1fcmV0dXJuc19yZXN1bHRzKGRyaXZlcik6CiAgICBkcml2ZXIuZ2V0KCJodHRwczovL3d3dy5nb29nbGUuY29tIikKICAgIHNlYXJjaF9ib3ggPSBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKAogICAgICAgIEVDLnByZXNlbmNlX29mX2VsZW1lbnRfbG9jYXRlZCgoQnkuTkFNRSwgInEiKSkKICAgICkKICAgIHNlYXJjaF9ib3guY2xlYXIoKQogICAgc2VhcmNoX2JveC5zZW5kX2tleXMoInNlbGVuaXVtIikKICAgIHNlYXJjaF9ib3guc3VibWl0KCkKICAgIHJlc3VsdHMgPSBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKAogICAgICAgIEVDLnByZXNlbmNlX2FsbF9lbGVtZW50c19sb2NhdGVkKCJkaXYjc2VhcmNoIGE... (base64-encoded content of the second test file)